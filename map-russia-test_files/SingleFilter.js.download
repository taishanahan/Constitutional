//>>built
require({cache:{"url:esri/dijit/templates/SingleFilter.html":'\x3cdiv class\x3d"esriSingleFilterForm singleFilter" id\x3d"${id}.singleFilter"\x3e\r\n  \x3cdiv\x3e\r\n    \x3ctable id\x3d"${id}.exprTable" class\x3d"rowTable" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd valign\x3d"top" nowrap\x3e\r\n            \x3cdiv id\x3d"${id}.column1"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd valign\x3d"top" nowrap\x3e\r\n            \x3cdiv id\x3d"${id}.column2"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd valign\x3d"top" nowrap\x3e\r\n            \x3cdiv id\x3d"${id}.column3"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd valign\x3d"top" nowrap\x3e\r\n            \x3cdiv id\x3d"${id}.column4"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd valign\x3d"top" nowrap\x3e\r\n            \x3cdiv id\x3d"${id}.column5"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd valign\x3d"top" nowrap\x3e\r\n            \x3cdiv id\x3d"${id}.column6"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd valign\x3d"top" nowrap\x3e\r\n            \x3cdiv id\x3d"${id}.column7"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd valign\x3d"top" nowrap\x3e\r\n            \x3ca id\x3d"${id}.deleteExpression" href\x3d"JavaScript:void(0);" style\x3d"margin:0 5px;display:none;" class\x3d"esriAGOFilterRemoveIcon" title\x3d"${i18n.deleteExpression}"\x3e\x3c/a\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"_interactiveFilterRow"\x3e\r\n          \x3ctd colspan\x3d"8"\x3e\r\n            \x3ctable cellpadding\x3d"0" cellspacing\x3d"0" class\x3d"interactiveFilter"\x3e\r\n              \x3ctbody\x3e\r\n                \x3ctr\x3e\r\n                  \x3ctd nowrap\x3d"nowrap"\x3e\r\n                    \x3ctable cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n                      \x3ctbody\x3e\r\n                        \x3ctr\x3e\r\n                          \x3ctd nowrap\x3d"nowrap"\x3e\r\n                            \x3cinput dojoAttachPoint\x3d"interactiveCheck" type\x3d"checkbox" class\x3d"promptCheckBox" title\x3d"${i18n.promptMsg}"/\x3e\r\n                          \x3c/td\x3e\r\n                          \x3ctd nowrap\x3d"nowrap"\x3e\r\n                            \x3clabel class\x3d"labels" for\x3d"promptCheckBox"\x3e\r\n                              \x26nbsp;\x26nbsp;${i18n.askForValues}\r\n                            \x3c/label\x3e\r\n                          \x3c/td\x3e\r\n                          \x3ctd\x3e\r\n                            \x3cspan dojoAttachPoint\x3d"interactiveArrow" style\x3d"color:#cbcbcb;cursor:pointer;" class\x3d"showHidePromptDiv"\x3e\x26nbsp;\x26#9660;\x3c/span\x3e\r\n                          \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                      \x3c/tbody\x3e\r\n                    \x3c/table\x3e\r\n                  \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n                \x3ctr dojoAttachPoint\x3d"interactiveSpace" style\x3d"display:none"\x3e\r\n                  \x3ctd nowrap\x3d"nowrap"\x3e\r\n                    \x3ctable cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n                      \x3ctbody\x3e\r\n                        \x3ctr\x3e\r\n                          \x3ctd nowrap\x3d"nowrap"\x3e\r\n                            ${i18n.prompt}\r\n                          \x3c/td\x3e\r\n                          \x3ctd width\x3d"10"\x3e\r\n                            \x26nbsp;\r\n                          \x3c/td\x3e\r\n                          \x3ctd\x3e\r\n                            \x3cdiv dojoAttachPoint\x3d"promptText" dojotype\x3d"dijit.form.TextBox" intermediateChanges\x3d"true" style\x3d"width:250px;"\x3e\r\n                            \x3c/div\x3e\r\n                          \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                        \x3ctr\x3e\r\n                          \x3ctd nowrap\x3d"nowrap"\x3e\r\n                            ${i18n.hint}\r\n                          \x3c/td\x3e\r\n                          \x3ctd width\x3d"10"\x3e\r\n                            \x26nbsp;\r\n                          \x3c/td\x3e\r\n                          \x3ctd\x3e\r\n                            \x3cdiv dojoAttachPoint\x3d"hintText" dojotype\x3d"dijit.form.TextBox" intermediateChanges\x3d"true" style\x3d"width:250px;"\x3e\r\n                            \x3c/div\x3e\r\n                          \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                      \x3c/tbody\x3e\r\n                    \x3c/table\x3e\r\n                  \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n              \x3c/tbody\x3e\r\n            \x3c/table\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"promptDiv" style\x3d"display:none;padding:10px 0px;"\x3e\r\n    \x3clabel class\x3d"labels promptLabels" for\x3d"txtPrompt"\x3e\r\n      ${i18n.prompt}\r\n    \x3c/label\x3e\r\n    \x3cinput class\x3d"promptFields txtPrompt" type\x3d"text"/\x3e\r\n    \x3cbr/\x3e\r\n    \x3clabel class\x3d"labels promptLabels" for\x3d"txtHint"\x3e\r\n      ${i18n.hint}\r\n    \x3c/label\x3e\r\n    \x3cinput class\x3d"promptFields txtHint" type\x3d"text" /\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e'}});
define("esri/dijit/SingleFilter","require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/json dojo/has dojo/json dojo/string dojo/number dojo/dom dojo/dom-style dojo/dom-attr dojo/dom-construct dojo/query dojo/dom-class dojo/_base/event dojo/Evented dojo/data/ItemFileWriteStore dojo/date/locale dojo/parser dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/_OnDijitClickMixin dijit/_FocusMixin dijit/registry dijit/form/TextBox dijit/form/FilteringSelect dijit/form/RadioButton dijit/form/DateTextBox dijit/form/NumberTextBox ../config ../kernel ../lang ../tasks/GenerateRendererTask ../tasks/UniqueValueDefinition ../tasks/GenerateRendererParameters ../layers/FeatureLayer ../layers/GeoRSSLayer ./analysis/ItemTypes dojo/i18n!../nls/jsapi dojo/text!./templates/SingleFilter.html".split(" "),
function(C,I,n,r,l,Z,aa,ba,J,z,m,t,ca,p,D,da,ea,K,y,x,L,M,N,O,P,Q,h,R,A,fa,E,F,G,S,u,B,T,U,V,W,ha,X,Y){C=I([M,N,O,P,Q,K],{declaredClass:"esri.dijit.SingleFilter",widgetsInTemplate:!0,templateString:Y,valueHandlers:[],onFieldChangeEnabled:!0,onOperatorChangeEnabled:!0,onPromptChangeHandler:null,onHintChangeHandler:null,fieldDomains:{},fieldsStore:null,fieldsInfo:{stringFieldsCount:0,numberFieldsCount:0,dateFieldsCount:0},stringOperatorStore:null,dateOperatorStore:null,numberOperatorStore:null,uniqueValuesStore:null,
isEnableInteractiveFilter:!0,uniqueValuesResults:{},partsObj:null,dayInMS:86399E3,allowAllDateTypes:!1,showUnique:!0,postMixInProperties:function(){this.inherited(arguments);this.i18n={};this.i18n=n.mixin(this.i18n,X.filterDlg)},parseExpressionTemplate:function(){var a=function(v,w){m.byId(w).className="attributeValueContainer";"field_dropdown"===v?m.byId(w).innerHTML=b:"operator_dropdown"===v?m.byId(w).innerHTML=c:"values_input"===v&&(m.byId(w).innerHTML=d+f)},b='\x3cselect id\x3d"'+this.id+'.fieldsList" class\x3d"attributeField" data-dojo-type\x3d"dijit/form/FilteringSelect" maxHeight\x3d"150" sortByLabel\x3d"true"\x3e\x3c/select\x3e',
c='\x3cselect id\x3d"'+this.id+'.operatorList" class\x3d"operator" data-dojo-type\x3d"dijit/form/FilteringSelect" maxHeight\x3d"150" sortByLabel\x3d"false"\x3e\x3c/select\x3e',d='\x3cdiv id\x3d"'+this.id+'.attributeValueContainer"\x3e\x3c/div\x3e',f='\x3cdiv class\x3d"attributeValueOptions"\x3e\x3ctable cellpadding\x3d"0" cellspacing\x3d"0"\x3e  \x3ctbody\x3e    \x3ctr\x3e      \x3ctd nowrap\x3d"nowrap"\x3e        \x3cinput id\x3d"'+this.id+'.radioValue" class\x3d"radioValue attributeValueRadio" checked\x3d"checked" name\x3d"'+
this.id+'.inputOption" data-dojo-type\x3d"dijit/form/RadioButton" title\x3d"'+this.i18n.valueTooltip+'"/\x3e        \x3clabel class\x3d"labels" title\x3d"'+this.i18n.valueTooltip+'"\x3e'+this.i18n.value+'        \x3c/label\x3e      \x3c/td\x3e      \x3ctd nowrap\x3d"nowrap" class\x3d"esriLeadingPadding05"\x3e        \x3cinput id\x3d"'+this.id+'.radioFields" class\x3d"radioFields attributeValueRadio" name\x3d"'+this.id+'.inputOption" data-dojo-type\x3d"dijit/form/RadioButton" title\x3d"'+this.i18n.fieldTooltip+
'"/\x3e        \x3clabel class\x3d"labels" title\x3d"'+this.i18n.fieldTooltip+'"\x3e'+this.i18n.field+'        \x3c/label\x3e      \x3c/td\x3e      \x3ctd id\x3d"'+this.id+'.radioUniqueColumn" nowrap\x3d"nowrap" class\x3d"esriLeadingPadding05"\x3e        \x3cinput id\x3d"'+this.id+'.radioUnique" class\x3d"radioUnique attributeValueRadio" name\x3d"'+this.id+'.inputOption" data-dojo-type\x3d"dijit/form/RadioButton" title\x3d"'+this.i18n.uniqueValueTooltip+'"/\x3e        \x3clabel class\x3d"labels" title\x3d"'+
this.i18n.uniqueValueTooltip+'"\x3e'+this.i18n.uniqueValues+"        \x3c/label\x3e      \x3c/td\x3e    \x3c/tr\x3e  \x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e",k=this.i18n.expressionTemplate,g=k.indexOf("${"),e=k.substring(0,g).trim();m.byId(this.id+".column1").innerHTML=e.length?"\x3cdiv class\x3d'attributeText'\x3e"+e+"\x3c/div\x3e":"";e=k.indexOf("}",g+1);var q=k.substring(g+2,e);a(q,this.id+".column2");g=k.indexOf("${",g+1);e=k.substring(e+1,g).trim();m.byId(this.id+".column3").innerHTML=e.length?
"\x3cdiv class\x3d'attributeText'\x3e"+e+"\x3c/div\x3e":"";e=k.indexOf("}",g+1);q=k.substring(g+2,e);a(q,this.id+".column4");g=k.indexOf("${",g+1);e=k.substring(e+1,g).trim();m.byId(this.id+".column5").innerHTML=e.length?"\x3cdiv class\x3d'attributeText'\x3e"+e+"\x3c/div\x3e":"";e=k.indexOf("}",g+1);q=k.substring(g+2,e);a(q,this.id+".column6");e=k.substring(e+1,k.length).trim();m.byId(this.id+".column7").innerHTML=e.length?"\x3cdiv class\x3d'attributeText'\x3e"+e+"\x3c/div\x3e":""},postCreate:function(){this.inherited(arguments);
this.parseExpressionTemplate();this.createOperatorStores();this.createFieldsStore(this.fields);this.readCodedValues();L.parse(m.byId(this.id+".exprTable")).then(n.hitch(this,function(a){l.connect(this.getFieldsList(),"onChange",this,"onChangeField");l.connect(this.getOperatorList(),"onChange",this,"onChangeOperator");l.connect(h.byId(this.id+".radioValue"),"onClick",this,"showValueInput");l.connect(h.byId(this.id+".radioFields"),"onClick",this,"showFields");l.connect(h.byId(this.id+".radioUnique"),
"onClick",this,"showUniqueList");this.version&&10.1>this.version&&this.mapLayer.url&&this.showUnique&&t.set(m.byId(this.id+".radioUniqueColumn"),"display","none");l.connect(m.byId(this.id+".deleteExpression"),"onclick",this,"onClickDeleteExpression");l.connect(this.interactiveCheck,"onclick",this,"onInteractiveClick");l.connect(this.interactiveArrow,"onclick",this,"onClickShowHideInteractive");this.enableInteractiveHandlers();this.isEnableInteractiveFilter||t.set(this._interactiveFilterRow,"display",
"none");t.set(m.byId(this.id+".radioUniqueColumn"),"display",this.showUnique?"block":"none");this.own(this.watch("showUnique",n.hitch(this,function(b,c,d){t.set(m.byId(this.id+".radioUniqueColumn"),"display",d?"block":"none")})))}))},constructor:function(a,b){this.id=a.id||"";this.owner=a.owner;this.version=a.version;this.part=a.part;this.fields=a.fields;this.mapLayer=a.mapLayer;!1===a.enableEvents&&(this.onOperatorChangeEnabled=this.onFieldChangeEnabled=!1)},init:function(a){if(!a.part||this.mapLayer&&
a.mapLayer&&this.mapLayer.id!==a.mapLayer.id)this.clearAttributeValueDijits(),this.mapLayer=a.mapLayer,this.version=a.version,this.fields=a.fields,this.createOperatorStores(),this.createFieldsStore(this.fields),this.readCodedValues(),this.fillFieldsList(this.fieldsStore),this.onChangeField();a.part&&(this.part=a.part,this.onOperatorChangeEnabled=this.onFieldChangeEnabled=!1,this.buildEditUIField(this.part,this))},destroy:function(){this.onOperatorChangeEnabled=this.onFieldChangeEnabled=!1;this.clearAttributeValueDijits();
r.forEach(h.findWidgets(m.byId(this.id)),function(a){a.destroyRecursive()});this.inherited(arguments)},toJson:function(){var a=null;this.isInteractiveChecked()&&(a={prompt:this.promptText.attr("value"),hint:this.hintText.attr("value")});return{fieldObj:this.getField(),operator:this.getOperator(),valueObj:this.getValue(),interactiveObj:a}},buildFriendlyTextExpr:function(a){var b=this.i18n.expressionTemplate,c=function(k,g,e){return J.substitute(b,{field_dropdown:k,operator_dropdown:g,values_input:e})};
if(!1===a.valueObj.isValid)return"\x26lt;expression is missing value\x26gt;";var d="";if("string"===a.fieldObj.shortType)a.operator===this.i18n.stringOperatorIsBlank||a.operator===this.i18n.stringOperatorIsNotBlank?d=c(a.fieldObj.label,a.operator,""):"field"===a.valueObj.type?d=c(a.fieldObj.label,a.operator,a.valueObj.label):(d=this.getDecodedValue(a.interactiveObj?a.interactiveObj.value:a.valueObj.value,a.fieldObj.name),d=c(a.fieldObj.label,a.operator,"'"+d+"'"));else if("number"===a.fieldObj.shortType)if(a.operator===
this.i18n.numberOperatorIsBetween||a.operator===this.i18n.numberOperatorIsNotBetween)d=a.interactiveObj?a.interactiveObj.value2:a.valueObj.value2,d=c(a.fieldObj.label,a.operator,z.format(a.interactiveObj?a.interactiveObj.value1:a.valueObj.value1,{pattern:"#####0.##########"})+" "+this.i18n.andBetweenValues+" "+z.format(d,{pattern:"#####0.##########"}));else if(a.operator===this.i18n.numberOperatorIsBlank||a.operator===this.i18n.numberOperatorIsNotBlank)d=c(a.fieldObj.label,a.operator,"");else if("field"===
a.valueObj.type)d=c(a.fieldObj.label,a.operator,a.valueObj.label);else{d=a.interactiveObj?a.interactiveObj.value:a.valueObj.value;var f=this.getDecodedValue(d,a.fieldObj.name);d=c(a.fieldObj.label,a.operator,d!==f?"'"+f+"'":z.format(d,{pattern:"#####0.##########"}))}else u.isDefined(a.valueObj.value)&&"field"!==a.valueObj.type&&"string"===typeof a.valueObj.value&&(a.valueObj.value=new Date(a.valueObj.value)),d=a.operator===this.i18n.dateOperatorIsBetween||a.operator===this.i18n.dateOperatorIsNotBetween?
c(a.fieldObj.label,a.operator,(a.interactiveObj?this.formatFriendlyDate(a.interactiveObj.value1):this.formatFriendlyDate(a.valueObj.value1))+" "+this.i18n.andBetweenValues+" "+(a.interactiveObj?this.formatFriendlyDate(a.interactiveObj.value2):this.formatFriendlyDate(this.addDay(a.valueObj.value2)))):a.operator===this.i18n.dateOperatorIsBlank||a.operator===this.i18n.dateOperatorIsNotBlank?c(a.fieldObj.label,a.operator,""):"field"===a.valueObj.type?c(a.fieldObj.label,a.operator,a.valueObj.label):c(a.fieldObj.label,
a.operator,a.interactiveObj?this.formatFriendlyDate(a.interactiveObj.value):this.formatFriendlyDate(a.valueObj.value));return d},builtSingleFilterString:function(a,b){if(u.isDefined(a.valueObj.isValid)&&!a.valueObj.isValid)return{whereClause:null};var c=a.valueObj.value,d=a.valueObj.value1,f=a.valueObj.value2,k=!1;if(a.interactiveObj){if(!a.interactiveObj.prompt||!a.interactiveObj.hint)return{whereClause:null};u.isDefined(b)&&(k=!0,u.isDefined(a.valueObj.value)&&(c="{"+b+"}"),u.isDefined(a.valueObj.value1)&&
(d="{"+b+"}"),u.isDefined(a.valueObj.value2)&&(f="{"+(b+1)+"}"))}var g="",e=a.fieldObj.name;this.mapLayer&&this.mapLayer.url&&-1!==this.mapLayer.url.indexOf("BigDataCatalogServer")&&this.hasWhiteSpace(e)&&(e='"'+e+'"');if("string"===a.fieldObj.shortType)switch(b="",c&&"field"!==a.valueObj.type&&this.isHostedService(this.mapLayer.url)&&this.containsNonLatinCharacter(c)&&(b="N"),a.operator){case this.i18n.stringOperatorIs:g="field"===a.valueObj.type?e+" \x3d "+c:e+" \x3d "+b+"'"+c.replace(/'/g,"''")+
"'";break;case this.i18n.stringOperatorIsNot:g="field"===a.valueObj.type?e+" \x3c\x3e "+c:e+" \x3c\x3e "+b+"'"+c.replace(/'/g,"''")+"'";break;case this.i18n.stringOperatorStartsWith:g=e+" LIKE "+b+"'"+c.replace(/'/g,"''")+"%'";break;case this.i18n.stringOperatorEndsWith:g=e+" LIKE "+b+"'%"+c.replace(/'/g,"''")+"'";break;case this.i18n.stringOperatorContains:g=e+" LIKE "+b+"'%"+c.replace(/'/g,"''")+"%'";break;case this.i18n.stringOperatorDoesNotContain:g=e+" NOT LIKE "+b+"'%"+c.replace(/'/g,"''")+
"%'";break;case this.i18n.stringOperatorIsBlank:g=e+" IS NULL";break;case this.i18n.stringOperatorIsNotBlank:g=e+" IS NOT NULL"}else if("number"===a.fieldObj.shortType)switch(a.operator){case this.i18n.numberOperatorIs:g=e+" \x3d "+c;break;case this.i18n.numberOperatorIsNot:g=e+" \x3c\x3e "+c;break;case this.i18n.numberOperatorIsAtLeast:g=e+" \x3e\x3d "+c;break;case this.i18n.numberOperatorIsLessThan:g=e+" \x3c "+c;break;case this.i18n.numberOperatorIsAtMost:g=e+" \x3c\x3d "+c;break;case this.i18n.numberOperatorIsGreaterThan:g=
e+" \x3e "+c;break;case this.i18n.numberOperatorIsBetween:g=e+" BETWEEN "+d+" AND "+f;break;case this.i18n.numberOperatorIsNotBetween:g=e+" NOT BETWEEN "+d+" AND "+f;break;case this.i18n.numberOperatorIsBlank:g=e+" IS NULL";break;case this.i18n.numberOperatorIsNotBlank:g=e+" IS NOT NULL"}else switch(u.isDefined(c)&&"field"!==a.valueObj.type&&"string"===typeof c&&(c=this.parseFriendlyDate(c)),a.operator){case this.i18n.dateOperatorIsOn:g="field"===a.valueObj.type?e+" \x3d "+c:k?e+" BETWEEN "+(this.supportsStandardizedQuery?
"timestamp ":"")+"'{"+b+"}' AND "+(this.supportsStandardizedQuery?"timestamp ":"")+"'{"+(b+1)+"}'":e+" BETWEEN "+(this.supportsStandardizedQuery?"timestamp ":"")+"'"+this.formatDate(c)+"' AND "+(this.supportsStandardizedQuery?"timestamp ":"")+"'"+this.formatDate(this.addDay(c))+"'";break;case this.i18n.dateOperatorIsNotOn:g="field"===a.valueObj.type?e+" \x3c\x3e "+c:k?e+" NOT BETWEEN "+(this.supportsStandardizedQuery?"timestamp ":"")+"'{"+b+"}' AND "+(this.supportsStandardizedQuery?"timestamp ":"")+
"'{"+(b+1)+"}'":e+" NOT BETWEEN "+(this.supportsStandardizedQuery?"timestamp ":"")+"'"+this.formatDate(c)+"' AND "+(this.supportsStandardizedQuery?"timestamp ":"")+"'"+this.formatDate(this.addDay(c))+"'";break;case this.i18n.dateOperatorIsBefore:g="field"===a.valueObj.type?e+" \x3c "+c:e+" \x3c "+(this.supportsStandardizedQuery?"timestamp ":"")+"'"+this.formatDate(c)+"'";break;case this.i18n.dateOperatorIsAfter:g="field"===a.valueObj.type?e+" \x3e "+c:e+" \x3e "+(this.supportsStandardizedQuery?"timestamp ":
"")+"'"+this.formatDate(this.addDay(c))+"'";break;case this.i18n.dateOperatorIsBetween:g=k?e+" BETWEEN '"+d+"' AND '"+f+"'":e+" BETWEEN "+(this.supportsStandardizedQuery?"timestamp ":"")+"'"+this.formatDate(d)+"' AND "+(this.supportsStandardizedQuery?"timestamp ":"")+"'"+this.formatDate(this.addDay(f))+"'";break;case this.i18n.dateOperatorIsNotBetween:g=k?e+" NOT BETWEEN '"+d+"' AND '"+f+"'":e+" NOT BETWEEN "+(this.supportsStandardizedQuery?"timestamp ":"")+"'"+this.formatDate(d)+"' AND "+(this.supportsStandardizedQuery?
"timestamp ":"")+"'"+this.formatDate(this.addDay(f))+"'";break;case this.i18n.dateOperatorIsBlank:g=e+" IS NULL";break;case this.i18n.dateOperatorIsNotBlank:g=e+" IS NOT NULL"}return{whereClause:g}},showDeleteIcon:function(){t.set(m.byId(this.id+".deleteExpression"),"display","block")},hideDeleteIcon:function(){t.set(m.byId(this.id+".deleteExpression"),"display","none")},createFieldsStore:function(a){if(a&&a.length){a=n.clone(a);a=a.sort(function(c,d){c.label=c.alias||c.name;d.label=d.alias||d.name;
return c.label<d.label?-1:c.label>d.label?1:0});var b=this.isHostedService(this.mapLayer.url);this.supportsStandardizedQuery=10.2<=this.mapLayer.version&&(this.mapLayer.useStandardizedQueries||this.isBigDataLayer(this.mapLayer));a=r.filter(a,function(c,d){return"esriFieldTypeString"===c.type||"esriFieldTypeDouble"===c.type||"esriFieldTypeSingle"===c.type||"esriFieldTypeInteger"===c.type||"esriFieldTypeSmallInteger"===c.type||"esriFieldTypeDate"===c.type&&(this.allowAllDateTypes||b||this.supportsStandardizedQuery)?
!0:!1},this);a=r.map(a,function(c,d){switch(c.type){case "esriFieldTypeString":var f="string";this.fieldsInfo.stringFieldsCount++;break;case "esriFieldTypeDate":f="date";this.fieldsInfo.dateFieldsCount++;break;default:f="number",this.fieldsInfo.numberFieldsCount++}return{id:d,label:c.label,shortType:f,alias:c.alias,editable:c.editable,name:c.name,nullable:c.nullable,type:c.type}},this);a.length&&(this.fieldsStore=new y({data:{identifier:"id",label:"label",items:a}}))}},createOperatorStores:function(){var a=
[];a.push({name:this.i18n.stringOperatorIs,name_:this.i18n.stringOperatorIs,id:0});a.push({name:this.i18n.stringOperatorIsNot,name_:this.i18n.stringOperatorIsNot,id:1});a.push({name:this.i18n.stringOperatorStartsWith,name_:this.i18n.stringOperatorStartsWith,id:2});a.push({name:this.i18n.stringOperatorEndsWith,name_:this.i18n.stringOperatorEndsWith,id:3});a.push({name:this.i18n.stringOperatorContains,name_:this.i18n.stringOperatorContains,id:4});a.push({name:this.i18n.stringOperatorDoesNotContain,
name_:this.i18n.stringOperatorDoesNotContain,id:5});a.push({name:this.i18n.stringOperatorIsBlank,name_:this.i18n.stringOperatorIsBlank,id:6});a.push({name:this.i18n.stringOperatorIsNotBlank,name_:this.i18n.stringOperatorIsNotBlank,id:7});this.stringOperatorStore=new y({data:{label:"name",identifier:"id",items:a}});a=[];a.push({name:this.i18n.dateOperatorIsOn,id:0});a.push({name:this.i18n.dateOperatorIsNotOn,id:1});a.push({name:this.i18n.dateOperatorIsBefore,id:2});a.push({name:this.i18n.dateOperatorIsAfter,
id:3});a.push({name:this.i18n.dateOperatorIsBetween,id:6});a.push({name:this.i18n.dateOperatorIsNotBetween,id:7});a.push({name:this.i18n.dateOperatorIsBlank,id:8});a.push({name:this.i18n.dateOperatorIsNotBlank,id:9});this.dateOperatorStore=new y({data:{label:"name",identifier:"id",items:a}});a=[];a.push({name:this.i18n.numberOperatorIs,name_:this.i18n.numberOperatorIs,id:0});a.push({name:this.i18n.numberOperatorIsNot,name_:this.i18n.numberOperatorIsNot,id:1});a.push({name:this.i18n.numberOperatorIsAtLeast,
name_:this.i18n.numberOperatorIsAtLeast,id:2});a.push({name:this.i18n.numberOperatorIsLessThan,name_:this.i18n.numberOperatorIsLessThan,id:3});a.push({name:this.i18n.numberOperatorIsAtMost,name_:this.i18n.numberOperatorIsAtMost,id:4});a.push({name:this.i18n.numberOperatorIsGreaterThan,name_:this.i18n.numberOperatorIsGreaterThan,id:5});a.push({name:this.i18n.numberOperatorIsBetween,name_:this.i18n.numberOperatorIsBetween,id:6});a.push({name:this.i18n.numberOperatorIsNotBetween,name_:this.i18n.numberOperatorIsNotBetween,
id:7});a.push({name:this.i18n.numberOperatorIsBlank,name_:this.i18n.numberOperatorIsBlank,id:8});a.push({name:this.i18n.numberOperatorIsNotBlank,name_:this.i18n.numberOperatorIsNotBlank,id:9});this.numberOperatorStore=new y({data:{label:"name",identifier:"id",items:a}})},readCodedValues:function(){r.forEach(this.mapLayer.fields,function(a){a.domain&&a.domain.codedValues&&(this.fieldDomains[a.name]=a.domain.codedValues)},this)},getDecodedValue:function(a,b){b=this.getCodedValues(b);var c;if(b)for(c=
0;c<b.length;c+=1){var d=b[c];if(d.code===a)return d.name}return a},getCodedValues:function(a){return this.fieldDomains[a]},getFieldsList:function(){return h.byId(this.id+".fieldsList")},getOperatorList:function(){return h.byId(this.id+".operatorList")},getValueFieldsList:function(){return h.byId(this.id+".valueFields")},getAttrValContNode:function(){return m.byId(this.id+".attributeValueContainer")},getField:function(){var a=this.getFieldsList();return{name:a.store.getValue(a.item,"name"),label:a.store.getValue(a.item,
"label"),shortType:a.store.getValue(a.item,"shortType"),type:a.store.getValue(a.item,"type")}},getOperator:function(){var a=this.getOperatorList();return a.item?a.store.getValue(a.item,"name"):""},getValue:function(){return{}},isInteractiveChecked:function(){return this.interactiveCheck.checked},setInteractiveSection:function(a,b,c){this.disableInteractiveHandlers();this.interactiveCheck.checked=a;this.promptText.attr("value",b);this.hintText.attr("value",c);t.set(this.interactiveSpace,"display",
"block");this.interactiveArrow.innerHTML="\x26nbsp;\x26#9650;";this.enableInteractiveHandlers()},enableInteractiveHandlers:function(){this.onPromptChangeHandler=l.connect(this.promptText,"onChange",this,"onChangeInteractive");this.onHintchangeHandler=l.connect(this.hintText,"onChange",this,"onChangeInteractive")},disableInteractiveHandlers:function(){l.disconnect(this.onPromptChangeHandler);l.disconnect(this.onHintChangeHandler)},fillFieldsList:function(a){var b=this.getFieldsList();b.set("labelAttr",
"label");b.set("searchAttr","label");b.set("store",a);b.set("value",0)},fillOperatorList:function(a,b,c){var d=this.getOperatorList();d.set("labelAttr","name");d.set("searchAttr","name");d.set("query",c?c:{});d.set("store",a);if(b){var f=!1;for(c=0;20>c&&(a.fetchItemByIdentity({identity:c,onItem:n.hitch(this,function(k){k&&k.name[0]===b&&(d.set("value",k.id[0]),f=!0)})}),!f);c++);}else d.set("value",0)},createValueString:function(a){var b=this.getAttrValContNode();this.clearAttributeValueDijits();
p.empty(b);if(a){b=new A({id:this.id+".value","class":"attributeValue",maxHeight:150,sortByLabel:!0},p.create("div",{},b));var c=this.buildCodedValuesStore(a);b.set("store",c);b.set("value",0);this.valueHandlers.push(l.connect(b,"onChange",this,"onValueChange"))}else b=new R({id:this.id+".value","class":"attributeValue",required:!0,placeHolder:"",intermediateChanges:!0},p.create("div",{},b)),this.valueHandlers.push(l.connect(b,"onChange",this,"onValueChange"));this.checkDefaultOption();this.getValue=
function(){var d=h.byId(this.id+".value"),f=!0;a?d.item?d=d.item.code[0]:(d="",f=!1):f=d=d.get("value");return{value:d,isValid:f}}},createValueDate:function(){var a=this.getAttrValContNode();this.clearAttributeValueDijits();p.empty(a);a=new E({id:this.id+".value","class":"attributeValue",trim:!0,required:!0,placeHolder:"",constraints:{formatLength:"short"}},p.create("div",{},a));this.checkDefaultOption();this.valueHandlers.push(l.connect(a,"onChange",this,"onValueChange"));this.getValue=function(){var b=
h.byId(this.id+".value").get("value");return{value:b,isValid:u.isDefined(b)}}},createValueNumber:function(a){var b=this.getAttrValContNode();this.clearAttributeValueDijits();p.empty(b);if(a){b=new A({id:this.id+".value","class":"attributeValue",maxHeight:150,sortByLabel:!0},p.create("div",{},b));var c=this.buildCodedValuesStore(a);b.set("store",c);b.set("value",0);this.valueHandlers.push(l.connect(b,"onChange",this,"onValueChange"))}else b=new F({id:this.id+".value","class":"attributeValue",required:!0,
placeHolder:"",intermediateChanges:!0,constraints:{pattern:"#####0.##########"}},p.create("div",{},b)),this.valueHandlers.push(l.connect(b,"onChange",this,"onValueChange"));this.checkDefaultOption();this.getValue=function(){var d=h.byId(this.id+".value"),f=!0;a?d.item?d=d.item.code[0]:(d="",f=!1):(d=d.get("value"),f=u.isDefined(d)&&!isNaN(d));return{value:d,isValid:f}}},createValueBetweenDate:function(){var a=this.getAttrValContNode();this.clearAttributeValueDijits();p.empty(a);var b=new E({id:this.id+
".value1","class":"attributeValue1",trim:!0,required:!0,placeHolder:"",constraints:{formatLength:"short"}},p.create("div",{},a));p.create("span",{innerHTML:this.i18n.andBetweenValues,"class":"attributeBetweenValues"},a);a=new E({id:this.id+".value2","class":"attributeValue2",trim:!0,required:!0,placeHolder:"",constraints:{formatLength:"short"}},p.create("div",{},a));this.checkDefaultOption();this.valueHandlers.push(l.connect(b,"onChange",this,"onValueChange"));this.valueHandlers.push(l.connect(a,
"onChange",this,"onValueChange"));this.getValue=function(){var c=h.byId(this.id+".value1").get("value"),d=h.byId(this.id+".value2").get("value");return{value1:c,value2:d,isValid:u.isDefined(c)&&u.isDefined(d)}}},createValueBetweenNumber:function(){var a=this.getAttrValContNode();this.clearAttributeValueDijits();p.empty(a);var b=new F({id:this.id+".value1","class":"attributeValue1",required:!0,placeHolder:"",intermediateChanges:!0,constraints:{pattern:"#####0.##########"}},p.create("div",{},a));p.create("span",
{innerHTML:this.i18n.andBetweenValues,"class":"attributeBetweenValues"},a);a=new F({id:this.id+".value2","class":"attributeValue2",required:!0,placeHolder:"",intermediateChanges:!0,constraints:{pattern:"#####0.##########"}},p.create("div",{},a));this.checkDefaultOption();this.valueHandlers.push(l.connect(b,"onChange",this,"onValueChange"));this.valueHandlers.push(l.connect(a,"onChange",this,"onValueChange"));this.getValue=function(){var c=h.byId(this.id+".value1").get("value"),d=h.byId(this.id+".value2").get("value");
return{value1:c,value2:d,isValid:u.isDefined(c)&&u.isDefined(d)&&!isNaN(c)&&!isNaN(d)&&c<=d}}},createValueInTheLastDate:function(){},createValueIsBlank:function(){var a=this.getAttrValContNode();this.clearAttributeValueDijits();p.empty(a);a.innerHTML="\x3cinput id\x3d'"+this.id+".value' class\x3d'attributeValue' type\x3d'text' disabled\x3d'true'/\x3e";this.checkDefaultOption();this.getValue=function(){return{value:null,isValid:!0}}},createValueFields:function(a,b,c){var d=this.getAttrValContNode();
this.clearAttributeValueDijits();p.empty(d);var f=new A({id:this.id+".valueFields","class":"attributeValue",maxHeight:150,labelAttr:"label",searchAttr:"label",store:a,query:b},p.create("div",{},d));if(c){var k=!1;for(d=0;100>d&&(a.fetchItemByIdentity({identity:d,onItem:n.hitch(this,function(g){g&&g.shortType[0]===b.shortType&&g.name[0]!==c&&(f.set("value",g.id),k=!0)})}),!k);d++);}this.valueHandlers.push(l.connect(f,"onChange",this,"onValueChange"));this.getValue=function(){var g=h.byId(this.id+".valueFields");
return{value:g.store.getValue(g.item,"name"),label:g.store.getValue(g.item,"label"),type:"field",isValid:!0}}},createValueUnique:function(a){var b=this.getAttrValContNode();this.clearAttributeValueDijits();p.empty(b);a=new A({id:this.id+".valueUnique","class":"attributeValue",maxHeight:150,store:a},p.create("div",{},b));a.set("value",0);this.valueHandlers.push(l.connect(a,"onChange",this,"onValueChange"));this.getValue=function(){var c=h.byId(this.id+".valueUnique");return{value:c.store.getValue(c.item,
"value"),isValid:!0}}},setValue:function(a,b){if(b)for(var c=0;c<b.length;c++){if(a===b[c].code){h.byId(this.id+".value").set("value",c);break}}else"date"===this.part.fieldObj.shortType?h.byId(this.id+".value").set("value",new Date(a)):("number"===this.part.fieldObj.shortType&&(a=Number(a)),h.byId(this.id+".value").set("value",a))},setValue1:function(a){"date"===this.part.fieldObj.shortType?a=new Date(a):"number"===this.part.fieldObj.shortType&&(a=Number(a));h.byId(this.id+".value1").set("value",
a)},setValue2:function(a){"date"===this.part.fieldObj.shortType?a=new Date(a):"number"===this.part.fieldObj.shortType&&(a=Number(a));h.byId(this.id+".value2").set("value",a)},setValueFieldById:function(a){this.getValueFieldsList().set("value",a)},enableOnFieldChange:function(){this.onFieldChangeEnabled=!0},enableOnOperatorChange:function(){this.onOperatorChangeEnabled=!0},onChangeField:function(a){this.onFieldChangeEnabled&&this._onChangeField(this.getFieldsList(),this)},onChangeOperator:function(a){this.onOperatorChangeEnabled&&
this._onChangeOperator(this.getOperatorList(),this)},onClickDeleteExpression:function(a){this._deleteExpression(this)},_onChangeField:function(a,b,c){var d=!!this.mapLayer&&this.isPortalHostedService(this.mapLayer.url);this.isBigDataLayer(this.mapLayer)||d&&"esriFieldTypeDate"===this.fieldsStore.getValue(a.item,"type")?t.set(m.byId(this.id+".radioUniqueColumn"),"display","none"):t.set(m.byId(this.id+".radioUniqueColumn"),"display","");d=b.getOperatorList();switch(this.fieldsStore.getValue(a.item,
"type")){case "esriFieldTypeString":var f=null;a=this.fieldsStore.getValue(a.item,"name");this.getCodedValues(a)&&(f=this.i18n.stringOperatorStartsWith,f+="|"+this.i18n.stringOperatorEndsWith,f+="|"+this.i18n.stringOperatorContains,f+="|"+this.i18n.stringOperatorDoesNotContain,f={name_:new RegExp("^(?!("+f+")$)")});d.attr("value")===this.i18n.stringOperatorIs?(b.fillOperatorList(this.stringOperatorStore,this.i18n.stringOperatorIs,f),this.onChangeOperator(d,b,c)):b.fillOperatorList(this.stringOperatorStore,
this.i18n.stringOperatorIs,f);b.createValueString(this.getCodedValues(a));break;case "esriFieldTypeDate":b.fillOperatorList(this.dateOperatorStore,this.i18n.dateOperatorIsOn);b.createValueDate();break;default:f=null,a=this.fieldsStore.getValue(a.item,"name"),this.getCodedValues(a)&&(f=this.i18n.numberOperatorIsBetween,f+="|"+this.i18n.numberOperatorIsNotBetween,f+="|"+this.i18n.numberOperatorIsAtLeast,f+="|"+this.i18n.numberOperatorIsLessThan,f+="|"+this.i18n.numberOperatorIsAtMost,f+="|"+this.i18n.numberOperatorIsGreaterThan,
f={name_:new RegExp("^(?!("+f+")$)")}),d.attr("value")===this.i18n.numberOperatorIs?(b.fillOperatorList(this.numberOperatorStore,this.i18n.numberOperatorIs,f),this.onChangeOperator(d,b,c)):b.fillOperatorList(this.numberOperatorStore,this.i18n.numberOperatorIs,f),b.createValueNumber(this.getCodedValues(a))}"date"===this.fieldsStore.getValue(b.getFieldsList().item,"shortType")?b.disableInteractiveCheck():b.enableInteractiveCheck();l.publish("filter-expression-change",this)},_onChangeOperator:function(a,
b,c){a=a.item?a.item.name[0]:a.value;c=this.fieldsStore.getValue(b.getFieldsList().item,"shortType");var d=this.fieldsStore.getValue(b.getFieldsList().item,"name");b.enableOptions();if("date"!==c&&"number"!==c||a!==this.i18n.dateOperatorIsBetween&&a!==this.i18n.numberOperatorIsBetween&&a!==this.i18n.dateOperatorIsNotBetween&&a!==this.i18n.numberOperatorIsNotBetween)if("date"!==c||a!==this.i18n.dateOperatorInTheLast&&a!==this.i18n.dateOperatorNotInTheLast)if(a===this.i18n.stringOperatorIsBlank||a===
this.i18n.dateOperatorIsBlank||a===this.i18n.numberOperatorIsBlank||a===this.i18n.stringOperatorIsNotBlank||a===this.i18n.dateOperatorIsNotBlank||a===this.i18n.numberOperatorIsNotBlank)b.createValueIsBlank(),b.disableOptions();else switch(c){case "string":b.createValueString(this.getCodedValues(d));break;case "date":b.createValueDate();break;default:b.createValueNumber(this.getCodedValues(d))}else b.disableOptions(),b.createValueInTheLastDate();else b.disableOptions(),"date"===c?b.createValueBetweenDate():
b.createValueBetweenNumber();l.publish("filter-expression-change",this)},onInteractiveClick:function(a){this.isInteractiveChecked()?(t.set(this.interactiveSpace,"display","block"),this.interactiveArrow.innerHTML="\x26nbsp;\x26#9650;"):(t.set(this.interactiveSpace,"display","none"),this.interactiveArrow.innerHTML="\x26nbsp;\x26#9660;");l.publish("filter-expression-change",this)},onClickShowHideInteractive:function(a){this.interactiveCheck.disabled||("none"===t.set(this.interactiveSpace,"display")?
(t.set(this.interactiveSpace,"display","block"),this.interactiveArrow.innerHTML="\x26nbsp;\x26#9650;"):(t.set(this.interactiveSpace,"display","none"),this.interactiveArrow.innerHTML="\x26nbsp;\x26#9660;"))},onChangeInteractive:function(){l.publish("filter-expression-change",this)},showValueInput:function(a){this._showValueInput(h.byNode(a.target),this)},showFields:function(a){this._showFields(h.byNode(a.target),this)},showUniqueList:function(a){this._showUniqueList(h.byNode(a.target),this)},onValueChange:function(){this.onValueChangeHandler&&
clearTimeout(this.onValueChangeHandler);this.onValueChangeHandler=setTimeout(n.hitch(this,function(){this.onValueChangeHandler=null;l.publish("filter-expression-change",this)}),800)},_showValueInput:function(a,b,c){b.onChangeOperator(a,b,c);b.enableInteractiveCheck()},_showFields:function(a,b,c){c=b.getFieldsList().item;a=this.fieldsStore.getValue(c,"shortType");c=this.fieldsStore.getValue(c,"name");b.createValueFields(this.fieldsStore,{shortType:a,name:new RegExp("^(?!"+c+"$)")},c);b.disableInteractiveCheck()},
_showUniqueList:function(a,b,c){this.uniqueValuesStore&&delete this.uniqueValuesStore;c=this.fieldsStore.getValue(b.getFieldsList().item,"name");if(10.1<=this.version||!this.mapLayer.url){var d=null;this.mapLayer.queryServiceUrl?d=this.mapLayer.queryServiceUrl:this.mapLayer.itemLayers&&r.forEach(this.mapLayer.itemLayers,function(f){f.id===this.layerInfo.id&&f.layerUrl&&(d=f.layerUrl)},this);d||(d=this.mapLayer.url);if(this.uniqueValuesResults[this.mapLayer.id+"_"+c])this.onGenerateRendererResults(b,
a,this.uniqueValuesResults[this.mapLayer.id+"_"+c]);else this.generateRendererUniqueValues(c,d,n.hitch(this,"onGenerateRendererResults",b,a),n.hitch(this,function(){this.showValueInput(a,b)}))}else a&&this.showValueInput(a,b)},onGenerateRendererResults:function(a,b,c){var d=this.fieldsStore.getValue(a.getFieldsList().item,"name"),f=this.fieldsStore.getValue(a.getFieldsList().item,"shortType"),k=this.fieldsStore.getValue(a.getFieldsList().item,"type");this.uniqueValuesResults[this.mapLayer.id+"_"+
d]=c;var g=null;r.forEach(this.mapLayer.fields,function(e){e.name===d&&e.domain&&(g=e.domain)});c=r.filter(c,function(e,q){return"string"===f?"\x3cNull\x3e"!==e&&""!==e.trim():"\x3cNull\x3e"!==e&&""!==e});c.length?("date"===f?(c=r.map(c,function(e){return new Date(e)}),c=c.sort(function(e,q){e=e.getTime();q=q.getTime();return e<q?-1:e>q?1:0}),c=r.map(c,function(e){return this.formatFriendlyDate(e)},this)):"number"===f?(c=r.map(c,function(e){return"esriFieldTypeDouble"===k||"esriFieldTypeSingle"===
k?parseFloat(e):parseInt(e,10)}),c=c.sort(function(e,q){return e<q?-1:e>q?1:0})):c=c.sort(function(e,q){return e<q?-1:e>q?1:0}),b=r.map(c,function(e,q){var v=e;"string"===f&&(v=""===e?"\x3c"+this.i18n.emptyString+"\x3e":e);if(g&&g.codedValues){for(var w=0;w<g.codedValues.length;w++){var H=g.codedValues[w];if(e===H.code)return{id:q,name:H.name||v,value:e}}return{id:q,name:""+v,value:e}}if("esriFieldTypeDouble"===k||"esriFieldTypeSingle"===k)v=z.format(e,{pattern:"#####0.##########"});return{id:q,name:""+
v,value:e}},this),this.uniqueValuesStore=new y({data:{label:"name",identifier:"id",items:b}}),a.createValueUnique(this.uniqueValuesStore)):this.showValueInput(b,a)},generateRendererUniqueValues:function(a,b,c,d){a instanceof Array&&(a=a.toString());var f=new T;f.attributeField=a;a=new U;a.classificationDefinition=f;this.mapLayer instanceof W?b=new B(this.mapLayer):this.mapLayer instanceof V&&!this.mapLayer.url?b=new B(this.mapLayer):this.hasDynamicLayers(this.mapLayer)?(f=this.mapLayer.layerDefinitions&&
this.mapLayer.layerDefinitions[this.mapLayer.id]?this.mapLayer.layerDefinitions[this.mapLayer.id]:null,a.where=f?f:null,b=new B(this.mapLayer.url+"/dynamicLayer",{source:this.layerInfo.source})):(f=this.mapLayer.getDefinitionExpression(),a.where=f?f:null,b=new B(b));G.defaults.io.timeout=1E4;b.execute(a,function(k){G.defaults.io.timeout=6E4;k=r.map(k.infos,function(g){return g.value});c(k)},n.hitch(this,function(k){G.defaults.io.timeout=6E4;d()}))},hasDynamicLayers:function(a){return a&&a.supportsDynamicLayers?
!0:!1},formatDate:function(a){return x.format(a,{datePattern:"yyyy-MM-dd",selector:"date"})+" "+x.format(a,{selector:"time",timePattern:"HH:mm:ss"})},formatFriendlyDate:function(a){return x.format(a,{formatLength:"short",selector:"date"})},parseFriendlyDate:function(a){return x.parse(a,{formatLength:"short",selector:"date"})},parseDate:function(a){var b=x.parse(a,{datePattern:"yyyy-MM-dd",timePattern:"HH:mm:ss"});b||(b=x.parse(a.replace(" ",", "),{datePattern:"yyyy-MM-dd",timePattern:"HH:mm:ss"}))||
(b=x.parse(a.replace(" "," - "),{datePattern:"yyyy-MM-dd",timePattern:"HH:mm:ss"}));return b},addDay:function(a){return new Date(a.getTime()+this.dayInMS)},subtractDay:function(a){return new Date(a.getTime()-this.dayInMS)},containsNonLatinCharacter:function(a){for(var b=0;b<a.length;b++)if(255<a.charCodeAt(b))return!0;return!1},hasWhiteSpace:function(a){return/\s/g.test(a)},buildCodedValuesStore:function(a){a=r.map(a,function(b,c){return{name:b.name,code:b.code,id:c}});return new y({data:{label:"name",
identifier:"id",items:a}})},clearAttributeValueDijits:function(){this.valueHandlers&&0!==this.valueHandlers.length&&(r.forEach(this.valueHandlers,n.hitch(this,function(a){l.disconnect(a);a=null})),this.valueHandlers=[],h.byId(this.id+".value")?h.byId(this.id+".value").destroy():m.byId(this.id+".value")&&this.getAttrValContNode().removeChild(m.byId(this.id+".value")),h.byId(this.id+".value1")?h.byId(this.id+".value1").destroy():m.byId(this.id+".value1")&&this.getAttrValContNode().removeChild(m.byId(this.id+
".value1")),h.byId(this.id+".value2")?h.byId(this.id+".value2").destroy():m.byId(this.id+".value2")&&this.getAttrValContNode().removeChild(m.byId(this.id+".value2")),h.byId(this.id+".valueFields")&&h.byId(this.id+".valueFields").destroy(),h.byId(this.id+".valueUnique")&&h.byId(this.id+".valueUnique").destroy())},checkDefaultOption:function(){D(".attributeValueOptions .attributeValueRadio",this.domNode).forEach(function(a){h.byNode(a).set("checked",-1<a.className.indexOf("radioValue"))})},disableOptions:function(){D(".attributeValueOptions .attributeValueRadio",
this.domNode).forEach(function(a){h.byNode(a).set("disabled",!0)})},enableOptions:function(){D(".attributeValueOptions .attributeValueRadio",this.domNode).forEach(function(a){h.byNode(a).set("disabled",!1)})},checkFieldOption:function(){h.byId(this.id+".radioFields").set("checked",!0)},disableFieldOption:function(){h.byId(this.id+".radioFields").set("disabled",!0)},disableUniqueOption:function(){h.byId(this.id+".radioUnique").set("disabled",!0)},enableInteractiveCheck:function(){this.interactiveCheck.disabled=
!1},disableInteractiveCheck:function(){this.interactiveCheck.checked=!1;this.interactiveCheck.disabled=!0},isBigDataLayer:function(a){return!!a.url&&-1!==a.url.indexOf("BigDataCatalogServer")&&("featureClass"===a.type||"table"===a.type)},isPortalHostedService:function(a){return a?-1!==a.toLowerCase().indexOf("/hosted/"):!1},isHostedService:function(a){if(!a)return!1;var b=-1!==a.indexOf(".arcgis.com/");a=-1!==a.indexOf("//services")||-1!==a.indexOf("//tiles")||-1!==a.indexOf("//features");return b&&
a},buildEditUIField:function(a,b,c){this.getFieldItemByName({name:a.fieldObj.name},n.hitch(this,function(d){b.getFieldsList().set("value",d.id[0],!1);this.buildEditUIOperator(a,b,c)}),n.hitch(this,function(){b.getFieldsList().set("value",0);this.buildEditUIOperator(a,b,c)}))},buildEditUIOperator:function(a,b,c){switch(a.fieldObj.shortType){case "string":b.fillOperatorList(this.stringOperatorStore,a.operator);break;case "date":b.fillOperatorList(this.dateOperatorStore,a.operator);break;default:b.fillOperatorList(this.numberOperatorStore,
a.operator)}setTimeout(n.hitch(this,function(){this.getOperatorItemByName(b.getOperatorList().store,{name:a.operator},n.hitch(this,function(d){b.getOperatorList().set("value",d.id[0],!1);this.buildEditUIValue(a,b,c)}),n.hitch(this,function(){b.getOperatorList().set("value",0);this.buildEditUIValue(a,b,c)}))}),100)},buildEditUIValue:function(a,b,c){this.onOperatorChangeEnabled=this.onFieldChangeEnabled=!0;var d=a.operator;this.onChangeOperator(b.getOperatorList(),b);b.enableOptions();setTimeout(n.hitch(this,
function(){d===this.i18n.stringOperatorIsBlank||d===this.i18n.dateOperatorIsBlank||d===this.i18n.numberOperatorIsBlank||d===this.i18n.stringOperatorIsNotBlank||d===this.i18n.dateOperatorIsNotBlank||d===this.i18n.numberOperatorIsNotBlank?(b.createValueIsBlank(),b.disableOptions()):"field"===a.valueObj.type?(b.createValueFields(this.fieldsStore,{shortType:a.fieldObj.shortType,name:new RegExp("^(?!"+a.fieldObj.name+"$)")}),b.checkFieldOption(),this.getFieldItemByName({name:a.valueObj.value},n.hitch(this,
function(f){b.setValueFieldById(f.id[0])}),n.hitch(this,function(){b.setValueFieldById(0)}))):u.isDefined(a.valueObj.value1)?(b.setValue1(a.valueObj.value1),b.setValue2(a.valueObj.value2)):b.setValue(a.valueObj.value,this.getCodedValues(a.fieldObj.name))}),100)},getFieldItemByName:function(a,b,c){this.fieldsStore.fetch({query:a,onComplete:n.hitch(this,function(d){d&&d.length?b(d[0]):c()})})},getOperatorItemByName:function(a,b,c,d){a.fetch({query:b,onComplete:n.hitch(this,function(f){f&&f.length?c(f[0]):
d()})})}});n.setObject("dijit.SingleFilter",C,S);return C});