//>>built
define("dgrid/selector","dojo/_base/kernel dojo/_base/array dojo/_base/lang dojo/on dojo/aspect dojo/_base/sniff put-selector/put".split(" "),function(v,w,x,A,q,y,n){x.getObject("dgrid.selector",!0);return dgrid.selector=function(d,h){function r(c){return!a.allowSelect(a.row(c))}function p(c){return function(b){var e=b.rows,f=e.length;b="false";var g;for(g=0;g<f;g++){var k=a.cell(e[g],d.id).element;k&&(k=(k.contents||k).input)&&!k.disabled&&(k.checked=c,k.setAttribute("aria-checked",c))}if("checkbox"==
l.type){e=a.selection;f=!1;for(g in e)if(e[g]!=a.allSelected){f=!0;break}l.indeterminate=f;l.checked=a.allSelected;f?b="mixed":a.allSelected&&(b="true");l.setAttribute("aria-checked",b)}}}function z(c){if("click"==c.type||32==c.keyCode||!y("opera")&&13==c.keyCode||0===c.keyCode){var b=a.row(c);a._selectionTriggerEvent=c;if(b){if(a.allowSelect(b)){var e=a._lastSelected&&a.row(a._lastSelected);"radio"==h?e&&e.id==b.id||(a.clearSelection(),a.select(b,null,!0),a._lastSelected=b.element):b&&(c.shiftKey?
p(!0)({rows:[b]}):e=null,e=c.shiftKey?e:null,a.select(e||b,b,e?void 0:null),a._lastSelected=b.element)}}else n(this,(a.allSelected?"!":".")+"dgrid-select-all"),a[a.allSelected?"clearSelection":"selectAll"]();a._selectionTriggerEvent=null}}function t(){a._hasSelectorInputListener=!0;m.push(a.on(".dgrid-selector:click,.dgrid-selector:keydown",z));var c=a._handleSelect;a._handleSelect=function(f){this.cell(f).column!=d&&c.apply(this,arguments)};if("function"==typeof d.disabled){var b=a.allowSelect,e=
d.disabled;a.allowSelect=function(f){var g=b.call(this,f);return e===r?g:g&&!e.call(d,f.data)}}d.disabled=r;m.push(a.on("dgrid-select",p(!0)));m.push(a.on("dgrid-deselect",p(!1)))}var m=[],a,l;d||(d={});d.type&&(d.selectorType=d.type,v.deprecated("columndef.type","use columndef.selectorType instead","dgrid 0.4"));d.selectorType=h=h||d.selectorType||"checkbox";d.sortable=!1;var u="function"==typeof h?h:function(c,b,e){var f=b.parentNode;a._hasSelectorInputListener||t();var g=d.disabled;n(f&&f.contents?
f:b,".dgrid-selector");b=b.input||(b.input=n(b,"input[type\x3d"+h+"]",{tabIndex:isNaN(d.tabIndex)?-1:d.tabIndex,disabled:g&&("function"==typeof g?g.call(d,e):g),checked:c}));b.setAttribute("aria-checked",!!c);return b};q.after(d,"init",function(){a=d.grid});q.after(d,"destroy",function(){w.forEach(m,function(c){c.remove()});a._hasSelectorInputListener=!1});d.renderCell=function(c,b,e,f,g){b=(b=c&&a.row(c))&&a.selection[b.id];u(b,e,c)};d.renderHeaderCell=function(c){var b="label"in d?d.label:d.field||
"";"radio"!=h&&a.allowSelectAll?u(!1,c,{}):(c.appendChild(document.createTextNode(b)),a._hasSelectorInputListener||t());l=c.lastChild};return d}});