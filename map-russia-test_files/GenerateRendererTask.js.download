//>>built
define("esri/tasks/GenerateRendererTask","require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/number dojo/_base/json dojo/_base/Deferred dojo/has ../kernel ../request ../deferredUtils ../urlUtils ../renderers/jsonUtils ./StatisticDefinition ./Task ./QueryTask ./query ./GenerateRendererParameters ./ClassificationDefinition ./ClassBreaksDefinition ./UniqueValueDefinition ./ColorRamp ./AlgorithmicColorRamp ./MultipartColorRamp".split(" "),function(w,p,n,t,q,x,u,I,y,z,A,B,C,v,D,E,F){p=p(D,
{declaredClass:"esri.tasks.GenerateRendererTask",_eventMap:{complete:["renderer"]},constructor:function(a,d){!n.isObject(a)||"esri.layers.FeatureLayer"!==a.declaredClass&&"esri.layers.CSVLayer"!==a.declaredClass?(this.url=a,this._url.path+="/generateRenderer"):a.url&&n.isString(a.url)&&"esri.layers.CSVLayer"!==a.declaredClass?(this.url=a.url,this._url=B.urlToObject(this.url),this._url.path+="/generateRenderer"):this._features=a.graphics;this._handler=n.hitch(this,this._handler);this.source=d&&d.source;
this.gdbVersion=d&&d.gdbVersion;this.checkValueRange=d&&d.checkValueRange;this.registerConnectEvents()},_handler:function(a,d,f,m,g){try{if("esri.renderer.ClassBreaksRenderer"===a.declaredClass||"esri.renderer.UniqueValueRenderer"===a.declaredClass)var c=a;else c=C.fromJson(a),"classBreaks"===a.type&&c.setMaxInclusive(!0);if(this.checkValueRange){var h=new E(this.url),b=new F,k=new v;k.statisticType="min";k.onStatisticField=this._field;var l=new v;l.statisticType="max";l.onStatisticField=this._field;
b.outStatistics=[k,l];h.execute(b).then(n.hitch(this,function(e){e=e.features[0].attributes;for(var r in e)if(0===r.toLowerCase().indexOf("min"))var G=e[r];else var H=e[r];c=this._processRenderer(c,this._prefix,this._unitLabel,this._formatLabel,this._precision,G,H);this._successHandler([c],"onComplete",f,g)}))}else c=this._processRenderer(c,this._prefix,this._unitLabel,this._formatLabel,this._precision),this._successHandler([c],"onComplete",f,g)}catch(e){this._errorHandler(e,m,g)}},_processRenderer:function(a,
d,f,m,g,c,h){"esri.renderer.ClassBreaksRenderer"===a.declaredClass?t.forEach(a.infos,function(b,k){0===k&&void 0!==c&&null!==c&&(b.minValue=c);k===a.infos.length-1&&void 0!==h&&null!==h&&(b.classMaxValue=b.maxValue=h);g&&(b.classMaxValue=b.maxValue=Math.round(b.maxValue/g)*g,b.minValue=Math.round(b.minValue/g)*g);m&&(b.label=q.format(b.minValue)+" - "+q.format(b.maxValue));d&&(b.label=d+" "+b.label);f&&(b.label=b.label+" "+f)}):t.forEach(a.infos,function(b,k){0===k&&void 0!==c&&null!==c&&(b.value=
c);k===a.infos.length-1&&void 0!==h&&null!==h&&(b.value=h);m&&(b.label=q.format(b.value));d&&(b.label=d+" "+b.label);f&&(b.label=b.label+" "+f)});return a},execute:function(a,d,f){var m=this._handler,g=this._errorHandler;this._precision=a.precision;this._prefix=a.prefix;this._unitLabel=a.unitLabel;this._formatLabel=a.formatLabel;if(this._features=a.features||this._features){var c=new u;var h=this._features;w(["./generateRenderer"],function(l){var e;"esri.tasks.ClassBreaksDefinition"===a.classificationDefinition.declaredClass?
e=l.createClassBreaksRenderer({features:h,definition:a.classificationDefinition}):"esri.tasks.UniqueValueDefinition"===a.classificationDefinition.declaredClass&&(e=l.createUniqueValueRenderer({features:h,definition:a.classificationDefinition}));e?m(e,null,d,f,c):g(null,f,c)})}else{var b=n.mixin(a.toJson(),{f:"json"});this._field="esri.tasks.ClassBreaksDefinition"===a.classificationDefinition.declaredClass?a.classificationDefinition.classificationField:a.classificationDefinition.attributeField;if(this.source){var k=
{source:this.source.toJson()};b.layer=x.toJson(k)}this.gdbVersion&&(b.gdbVersion=this.gdbVersion);c=new u(A._dfdCanceller);c._pendingDfd=z({url:this._url.path,content:b,callbackParamName:"callback",load:function(l,e){m(l,e,d,f,c)},error:function(l){g(l,f,c)}})}return c},onComplete:function(){}});n.setObject("tasks.GenerateRendererTask",p,y);return p});