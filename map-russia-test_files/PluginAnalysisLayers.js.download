//>>built
define("esri/dijit/analysis/PluginAnalysisLayers","dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/promise/all dojo/has ../../kernel dojo/i18n!../../nls/jsapi".split(" "),function(f,d,g,l,m,h,k){var e=f(null,{filters:{all:{},categoryBoundaries:{tags:["boundaries","places"]},subCategoryBoundaries:{tags:["boundaries"]},subCategoryPlaces:{tags:["places"]},categoryHexBins:{tags:["hex"]},categoryTransportation:{tags:["transportation"]}},constructor:function(a){d.mixin(this,a);this.i18n=d.mixin({},
k.browseLayersDlg);this.filterStrings={all:{title:this.i18n.categoryAll},categoryBoundaries:{title:this.i18n.categoryBoundaries},subCategoryBoundaries:{title:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"+this.i18n.subCategoryBoundaries},subCategoryPlaces:{title:"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"+this.i18n.subCategoryPlaces},categoryHexBins:{title:this.i18n.categoryHexBins},categoryTransportation:{title:this.i18n.categoryTransportation}}},fetchData:function(){this._portal=this.parent._portal;var a;return this._fetchGroups().then(d.hitch(this,
function(b){a=g.map(b||[],function(c){if(c)return'group:"'+c.id+'"'});return this._fetchGroupItems(a)}))},_fetchGroup:function(a,b){this._groups=this._groups||[];return this._groups[a]||this._portal.queryGroups(b,!0).then(d.hitch(this,function(c){0<c.total&&c.results&&(this._groups[a]=c.results);return this._groups[a]||[]}))},_fetchGroupItems:function(a,b){var c=this._isCustom?['-typekeywords:"Multilayer"']:['typekeywords:"Analysis Ready"'];this._portal&&this._portal.user&&this._portal.user.demographics||
c.push('-typekeywords:"Requires Credits"');return this.parent._fetchItems({groups:a,query:b,types:['type:"Map Service"','type:"Feature Service"'],typekeywords:c})},_fetchGroups:function(){return this._fetchEsriAnalysisLayers()},_fetchEsriAnalysisLayers:function(){if(this._portal&&this._portal.analysisLayersGroupQuery){var a=this._portal.analysisLayersGroupQuery;this._isCustomAnalysisQuery()&&(this.filterStrings=this.filters=null)}return this._fetchGroup("esriAnalysisLayers",{q:a,num:100,start:0}).then(d.hitch(this,
function(b){b&&0<b.length&&(this.parent.sortAttribute=b[0].sortField,this.parent.sortDescending="asc"!==b[0].sortOrder);return b}))},_isCustomAnalysisQuery:function(){var a='title:"Living Atlas Analysis Layers" AND owner:esri',b=!1;this._portal&&this._portal.isPortal&&(a='title:"Living Atlas Analysis Layers" AND owner:esri_livingatlas');this._portal&&this._portal.analysisLayersGroupQuery&&this._portal.analysisLayersGroupQuery!==a&&(b=!0);return this._isCustom=b}});d.mixin(e,{add:function(a,b){a.plugIn||
(b=b||{},b.parent=a,a.plugIn=new e(b))},remove:function(a){a.plugIn&&(a.plugIn.destroy(),delete a.plugIn)}});d.setObject("dijit.analysis.PluginAnalysisLayers",e,h);return e});